/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torchvision/datapoints/__init__.py:12: UserWarning: The torchvision.datapoints and torchvision.transforms.v2 namespaces are still Beta. While we do not expect major breaking changes, some APIs may still change according to user feedback. Please submit any feedback you may have in this issue: https://github.com/pytorch/vision/issues/6753, and you can also check out https://github.com/pytorch/vision/issues/7319 to learn more about the APIs that we suspect might involve future changes. You can silence this warning by calling torchvision.disable_beta_transforms_warning().
  warnings.warn(_BETA_TRANSFORMS_WARNING)
/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torchvision/transforms/v2/__init__.py:54: UserWarning: The torchvision.datapoints and torchvision.transforms.v2 namespaces are still Beta. While we do not expect major breaking changes, some APIs may still change according to user feedback. Please submit any feedback you may have in this issue: https://github.com/pytorch/vision/issues/6753, and you can also check out https://github.com/pytorch/vision/issues/7319 to learn more about the APIs that we suspect might involve future changes. You can silence this warning by calling torchvision.disable_beta_transforms_warning().
  warnings.warn(_BETA_TRANSFORMS_WARNING)
Traceback (most recent call last):
  File "/projappl/project_2014099/lmdrive-original/LAVIS/train.py", line 16, in <module>
    import lavis.tasks as tasks
  File "/projappl/project_2014099/lmdrive-original/LAVIS/lavis/__init__.py", line 16, in <module>
    from lavis.models import *
  File "/projappl/project_2014099/lmdrive-original/LAVIS/lavis/models/__init__.py", line 43, in <module>
    from lavis.models.blip_diffusion_models.blip_diffusion import BlipDiffusion
  File "/projappl/project_2014099/lmdrive-original/LAVIS/lavis/models/blip_diffusion_models/blip_diffusion.py", line 29, in <module>
    from lavis.models.blip_diffusion_models.modeling_ctx_clip import CtxCLIPTextModel
  File "/projappl/project_2014099/lmdrive-original/LAVIS/lavis/models/blip_diffusion_models/modeling_ctx_clip.py", line 13, in <module>
    from transformers.models.clip.modeling_clip import (
ImportError: cannot import name '_expand_mask' from 'transformers.models.clip.modeling_clip' (/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/transformers/models/clip/modeling_clip.py)
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2675750) of binary: /projappl/project_2014099/envlmdrive/bin/python
Traceback (most recent call last):
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/run.py", line 798, in <module>
    main()
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/MAHTI_TYKKY_9QXaOsY/miniforge/envs/env1/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/projappl/project_2014099/lmdrive-original/LAVIS/train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-01-17_13:01:25
  host      : g1101.mahti.csc.fi
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2675750)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
